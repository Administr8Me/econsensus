{% extends "fullpage.html" %}
{% load i18n %}

{% block title %}
{% if decision.excerpt %}
	{{ decision.excerpt|safe }}
{% else %}
	{% trans "Add New Decision" %}
{% endif %}{% endblock %}

{% block body_class%}decision-list{% endblock %}

{% block head_content %}
{{ decision_form.media }}
{% endblock %}

{% block heading %}
{% if decision.excerpt %}
	{% trans "View and Edit: " %}{{ decision.excerpt|safe }}
{% else %}
	{% trans "Add New Decision" %}
{% endif %}
{% endblock %}

{% block content %}
<h2>{{ decision_form.instance.excerpt|safe }}</h2>
<form id="decision_add" action="" method="post">{% csrf_token %}
	{% for error in decision_form.non_field_errors %}
	    <p class="error" >{{ error }}</p>
	{% endfor %}
	<div class="form_row decision_summary">
	    <div class="form_item short_name">
	        {{ decision_form.description.errors }}
	        {{ decision_form.description }}
	    </div>
	    <div class="form_item status">
	        {{ decision_form.status.errors }}
	        <label for="id_status">{% trans "Status" %}:</label>
	        {{ decision_form.status }}
	    </div>
	 </div>
	 
	 <div class="form_row dates">
	     <div class="form_item">
	        {{ decision_form.decided_date.errors }}
	        <label for="id_decided_date">{% trans "Decided" %}:</label>
	        {{ decision_form.decided_date }}
	    </div>
		<div class="form_item">
	        {{ decision_form.effective_date.errors }}
	        <label for="id_effective_date">{% trans "Effective" %}:</label>
	        {{ decision_form.effective_date }}
	    </div>
		<div class="form_item">
	        {{ decision_form.review_date.errors }}
	        <label for="id_review_date">{% trans "Review" %}:</label>
	        {{ decision_form.review_date }}
	    </div>
		<div class="form_item">
	        {{ decision_form.expiry_date.errors }}
	        <label for="id_expiry_date">{% trans "Expiry" %}:</label>
	        {{ decision_form.expiry_date }}
	    </div>
	 </div>
	 
	  <div class="form_row watchers">
	     <div class="form_item">
	        <label for="id_watchers">{% trans "watchers" %}:</label>
	        {{decision.watchers.all|join:"," }}
	    </div>
	   </div>
	  <div class="form_row watchers">
	     <div class="form_item">
	        <label for="id_author">{% trans "Author" %}:</label>
	        {{ decision.author }}
	    </div>
	 </div>
	    
	 <div class="form_row resources">
	 	<div class="form_item budget">
	        {{ decision_form.budget.errors }}
	        <label for="id_budget">{% trans "Budget/Resources" %}:</label>
	        {{ decision_form.budget }}
	    </div>
	    <div class="form_item people">
	        {{ decision_form.people.errors }}
	        <label for="id_people">{% trans "People" %}:</label>
	        {{ decision_form.people }}
	    </div>
	 </div>
	 
	<div id="tags">
	    {{ decision_form.tags.errors }}
	    <label for="id_tags">{% trans "Tags" %}:</label>
	    {{ decision_form.tags }} {{ decision_form.tags.help_text }}
	</div>
	
	<div id="feedback">
		<h2>{% trans "Feedback" %}</h2>
		{{ feedback_formset.management_form }}
		{% for feedback_form in feedback_formset %}
		{{ feedback_form.id }}
		<div class="formset_item">
			<div class="form_row feedback_summary">
				<div class="form_item rating">
					{{ feedback_form.rating.errors }}
					<label for="id_rating">{% trans "Rating" %}:</label>
					{{ feedback_form.rating }}
		    	</div>
		    	<div class="form_item description">
					{{ feedback_form.description.errors }}
					{{ feedback_form.description }}
		    	</div>
		    </div>
		</div>
	    {% endfor %}		
	</div>
	
	<div class="form_row decision_submit">
	    <input class="go button" name = "submit" type="submit" value="{% trans "Save" %}" />
	    <input class="go button" name = "submit" type="submit" value="{% trans "Cancel" %}" />
	    
		<div class="form_item watch">
	        {{ decision_form.watch.errors }}
	        <label for="id_watch">{% trans "Watch" %}?</label>
	        {{ decision_form.watch }}
	    </div>
	</div>
</form>
{% endblock %}
